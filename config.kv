ScreenManager:
    StartScreen:
    BalanceScreen:
    PaymentsScreen:
    RegularOperationsScreen:
    StatisticsScreen:
    AddRegularOperationScreen:
    SecretMenuScreen:
    ChangeRegularOperationScreen:
    RegularOperationTypesScreen:

<StartScreen>:
    name: "main"
    MDScreen:
        MDGridLayout:
            cols: 1
            pos_hint: {"center_x": 0.5}
            adaptive_width: True
            MDGridLayout:
                cols: 1
                rows: 2
                MDLabel:
                    text: "Контроллер баланса"
                    halign: 'center'
                    font_style: 'H4'
                    font_size: '30sp'
                MDGridLayout:
                    cols: 2
                    MDGridLayout:
                        rows: 2
                        MDLabel:
                            text: "Текущий баланс\n"
                            halign: 'center'
                            font_style: 'H4'
                            font_size: '25sp'
                        MDLabel:
                            text: root.get_balance()
                            halign: 'center'
                            font_style: 'H4'
                            font_size: '120sp'
                    MDGridLayout:
                        rows: 2
                        MDLabel:
                            text: "Баланс платежей\n"
                            halign: 'center'
                            font_style: 'H4'
                            font_size: '25sp'
                        MDLabel:
                            text: root.get_payments()
                            halign: 'center'
                            font_style: 'H4'
                            font_size: '120sp'
            MDGridLayout:
                cols: 2
                rows: 4
                adaptive_width: True
                spacing: "50dp"
                padding: "50dp"
                pos_hint: {"center_x": 0.5}
        
                MDFillRoundFlatIconButton:
                    text: "Управление балансом счета"
                    on_release:
                        app.root.current="balance"
                MDFillRoundFlatIconButton:
                    text: "Управление балансом платежей"
                    on_release:
                        app.root.current="payments"
                MDFillRoundFlatIconButton:
                    text: "Список операций"
                    halign: 'center'
                    pos_hint: {'center_y':0.4}
                    spacing: 100
                    padding: 50
                    on_release:
                        app.root.current="reg_ops"
                        root.manager.transition.direction = "left"
                MDFillRoundFlatIconButton:
                    text: "Статистика"
                    pos_hint:{'center_y':0.9}
                    on_release:
                        app.root.current="stats"
                        root.manager.transition.direction = "right"
                        
                MDFillRoundFlatIconButton:
                    cols: 2
                    text: "Добавить регулярную операцию"
                    on_release:
                        app.root.current="add_reg_op"
                        root.manager.transition.direction = "up"

<BalanceScreen>:
    name: "balance"
    GridLayout:
        cols: 1
        GridLayout:
            cols: 2
            Label:
                text: "Управление балансом"
                font_size: '30sp'
            Label:
                text: "Текущий баланс: %s" % root.balstr
                font_size: '30sp'
        GridLayout:
            cols: 1
            Label:
                text: "Введите название"
            TextInput:
                id: new_balance
        GridLayout:
            cols: 2
            Button:
                text: "Сохранить"
                on_release:
                    root.change_balance(new_balance.text)
                    app.root.current="main"
            Button:
                text: "Отмена"
                on_release:
                    app.root.current="main"

<PaymentsScreen>:
    name: "payments"
    GridLayout:
        cols: 1
        GridLayout:
            cols: 2
            Label:
                text: "Управление балансом"
                font_size: '30sp'
            Label:
                text: "Текущий баланс: %s" % root.balstr
                font_size: '30sp'
        GridLayout:
            cols: 1
            Label:
                text: "Введите название"
            TextInput:
                id: new_balance
        GridLayout:
            cols: 2
            Button:
                text: "Сохранить"
                on_release:
                    root.change_balance(new_balance.text)
                    app.root.current="main"
            Button:
                text: "Отмена"
                on_release:
                    app.root.current="main"

<RegularOperationsScreen>:
    name: "reg_ops"
    GridLayout:
        cols: 1
        MDLabel:
            text: "Добавление регулярной операции"
            halign: 'center'
            pos_hint: {'center_y':0.9}
            font_style: 'H4'
        GridLayout:
            cols: 1
            GridLayout:
                cols: 1
                id: reg_ops_list
        Button:
            text: "Вернуться"
            on_release:
                app.root.current="main"
                root.manager.transition.direction = "right"

<ChangeRegularOperationScreen>:
    name: "reg_op_change"
    GridLayout:
        cols: 1
        MDLabel:
            text: "Редактирование регулярной операции"
            halign: 'center'
            pos_hint: {'center_y':0.9}
            font_style: 'H4'
        GridLayout:
            cols: 2
            MDLabel:
                text: "Введите название"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: reg_op_name
        GridLayout:
            cols: 2
            MDLabel:
                text: "Выбор типа регулярной операции"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            Spinner:
                id: reg_op_type
                text: "Выберите тип регулярной операции"
                values: root.reg_op_types
        GridLayout:
            cols: 2
            MDLabel:
                text: "Сумма регулярной операции"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: reg_op_sum
        GridLayout:
            cols: 2
            MDLabel:
                text: "Выбор периодичности"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            Spinner:
                id: reg_op_period
                text: "Выберите периодичность регулярной операции"
                values: ["Каждый день", "Каждую неделю", "Каждый месяц", "Каждый год"]
        GridLayout:
            cols: 2
            MDLabel:
                text: "Настройка уведомления"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            Spinner:
                id: reg_op_notification
                text: "Выберите периодичность уведомлений"
                values: ["За месяц", "За неделю", "За день", "В тот же день", "Через день"]
        GridLayout:
            cols: 2
            Button:
                text: "Удалить операцию"
                on_release:
                    root.remove_reg_op()
            Button:
                text: "Сохранить изменения"
                on_release:
                    root.update_reg_op(reg_op_name.text, reg_op_type.text, reg_op_sum.text, reg_op_period.text, reg_op_notification.text)
        GridLayout:
            cols: 2
            Button:
                text: "Управление типами"
                on_release:
                    app.root.current="types"
                    root.manager.transition.direction = "up"
            Button:
                text: "Вернуться"
                on_release:
                    app.root.current="main"
                    root.manager.transition.direction = "down"


<AddRegularOperationScreen>:
    name: "add_reg_op"
    GridLayout:
        cols: 1
        MDLabel:
            text: "Добавление регулярной операции"
            halign: 'center'
            pos_hint: {'center_y':0.9}
            font_style: 'H4'        
        GridLayout:
            cols: 2
            MDLabel:
                text: "Введите название"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: reg_op_name
        GridLayout:
            cols: 2
            MDLabel:
                text: "Выбор типа регулярной операции"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            Spinner:
                id: reg_op_type
                text: "Выберите тип регулярной операции"
                values: root.reg_op_types
        GridLayout:
            cols: 2
            MDLabel:
                text: "Сумма регулярной операции"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: reg_op_sum
        GridLayout:
            cols: 2
            MDLabel:
                text: "Выбор периодичности"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            Spinner:
                id: reg_op_period
                text: "Выберите периодичность регулярной операции"
                values: ["Каждый день", "Каждую неделю", "Каждый месяц", "Каждый год"]
        GridLayout:
            cols: 2
            MDLabel:
                text: "Настройка уведомления"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            Spinner:
                id: reg_op_notification
                text: "Выберите периодичность уведомлений"
                values: ["За месяц", "За неделю", "За день", "В тот же день", "Через день"]
        GridLayout:
            cols: 3
            Button:
                text: "Вернуться"
                on_release:
                    app.root.current="main"
                    root.manager.transition.direction = "down"
            Button:
                text: "Управление типами"
                on_release:
                    app.root.current="types"
                    root.manager.transition.direction = "up"
            Button:
                text: "Добавить"
                on_release:
                    root.add_reg_op(reg_op_name.text, reg_op_type.text, reg_op_sum.text, reg_op_period.text, reg_op_notification.text)


<RegularOperationTypesScreen>:
    name: "types"
    GridLayout:
        cols: 1
        MDLabel:
            text: "Управление типами регулярных операций"
            halign: 'center'
            pos_hint: {'center_y':0.9}
            font_style: 'H4'
        GridLayout:
            cols: 3
            MDLabel:
                text: "Добавление типа"
                halign: 'center'
                pos_hint: {'center_y':0.9}
                font_style: 'H4'
            TextInput:
                id: type_name
            Button:
                text: "Добавить"
                on_release:
                    root.add(type_name.text)
        GridLayout:
            cols: 3
            MDLabel:
                text: "Удаление типа"
                halign: 'center'
                pos_hint: {'center_y':0.9}
                font_style: 'H4'
            Spinner:
                id: type_to_delete
                text: "Выберите тип регулярной операции"
                values: root.reg_op_types
            Button:
                text: "Удалить"
                on_release:
                    root.remove(type_to_delete.text)
        Button:
            text: "Вернуться"
            on_release:
                app.root.current="main"
                root.manager.transition.direction = "down"

<StatisticsScreen>:
    name: "stats"
    GridLayout:
        cols: 1
        MDLabel:
            text: "Статистика"
            halign: 'center'
            pos_hint: {'center_y':0.9}
            font_style: 'H4'
        GridLayout:
            cols: 2
            MDLabel:
                text: "Введите дату начала периода аналитики"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: start_date
        GridLayout:
            cols: 2
            MDLabel:
                text: "Введите дату окончания периода аналитики"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: end_date
        GridLayout:
            cols: 2
            MDLabel:
                text: "Выбор типа регулярной операции"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            Spinner:
                id: reg_op_type_stat
                text: "Выберите тип регулярной операции"
                values: root.reg_op_types_statistics   
        GridLayout:
            cols: 2
            MDLabel:
                text: "Сумма прихода за период:"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: total_income
        GridLayout:
            cols: 2
            MDLabel:
                text: "Сумма платежей за период:"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: total_spend
        GridLayout:
            cols: 2
            MDLabel:
                text: "Итог:"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: total
        GridLayout:
            cols: 2
            Button:
                text: "Посчитать"
                on_release:
                    root.get_statistics(reg_op_type_stat.text, start_date.text, end_date.text)

            Button:
                text: "Вернуться"
                on_release:
                    app.root.current="main"
                    root.manager.transition.direction = "left"
                

<SecretMenuScreen>:
    name: "secret"
    Button:
        text: "Вернуться"
        on_release:
            app.root.current="main"
            root.manager.transition.direction = "left"