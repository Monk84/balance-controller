ScreenManager:
    StartScreen:
    BalanceScreen:
    RegularOperationsScreen:
    RegularOperationTypesScreen:
    StatisticsScreen:
    AddRegularOperationScreen:
    SecretMenuScreen:
    ChangeRegularOperationScreen:

<StartScreen>:
    name: "main"
    GridLayout:
        cols: 1
        GridLayout:
            cols: 1
            MDLabel:
                text: "Контроллер баланса"
                halign: 'center'
                pos_hint: {'center_y':0.9}
                font_style: 'H4'
                font_size: '30sp'
            MDLabel:
                text: "Текущий баланс: " + root.get_balance()
                halign: 'center'
                pos_hint: {'center_y':0.9}
                font_style: 'H4'
                font_size: '30sp'            
            MDFillRoundFlatIconButton:
                text: "Управление балансом"
                on_release:
                    app.root.current="balance"
            MDFillRoundFlatIconButton:
                text: "К регулярным операциям"
                halign: 'center'
                pos_hint: {'center_y':0.4}
                spacing: 100
                padding: 50
                on_release:
                    app.root.current="reg_ops"
                    root.manager.transition.direction = "left"
            MDFillRoundFlatIconButton:
                text: "К статистике"
                pos_hint:{'center_y':0.9}
                on_release:
                    app.root.current="stats"
                    root.manager.transition.direction = "right"
                    
            MDFillRoundFlatIconButton:
                cols: 2
                text: "Добавить регулярную операцию"
                on_release:
                    app.root.current="add_reg_op"
                    root.manager.transition.direction = "up"

<BalanceScreen>:
    name: "balance"
    GridLayout:
        cols: 1
        GridLayout:
            cols: 2
            Label:
                text: "Управление балансом"
                font_size: '30sp'
            Label:
                text: "Текущий баланс: %s" % root.balstr
                font_size: '30sp'
        GridLayout:
            cols: 1
            Label:
                text: "Введите название"
            TextInput:
                id: new_balance
        GridLayout:
            cols: 2
            Button:
                text: "Сохранить"
                on_release:
                    root.change_balance(new_balance.text)
                    app.root.current="main"
            Button:
                text: "Отмена"
                on_release:
                    app.root.current="main"

<RegularOperationsScreen>:
    name: "reg_ops"
    GridLayout:
        cols: 1
        MDLabel:
            text: "Добавление регулярной операции"
            halign: 'center'
            pos_hint: {'center_y':0.9}
            font_style: 'H4'
        GridLayout:
            cols: 1
            GridLayout:
                cols: 1
                id: reg_ops_list
        Button:
            text: "Вернуться"
            on_release:
                app.root.current="main"
                root.manager.transition.direction = "right"

<ChangeRegularOperationScreen>:
    name: "reg_op_change"
    GridLayout:
        cols: 1
        MDLabel:
            text: "Редактирование регулярной операции"
            halign: 'center'
            pos_hint: {'center_y':0.9}
            font_style: 'H4'
        GridLayout:
            cols: 2
            MDLabel:
                text: "Введите название"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: reg_op_name
        GridLayout:
            cols: 2
            MDLabel:
                text: "Выбор типа регулярной операции"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            Spinner:
                id: reg_op_type
                text: "Выберите тип регулярной операции"
                values: root.reg_op_types
        GridLayout:
            cols: 2
            MDLabel:
                text: "Сумма регулярной операции"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: reg_op_sum
        GridLayout:
            cols: 2
            MDLabel:
                text: "Выбор периодичности"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            Spinner:
                id: reg_op_period
                text: "Выберите периодичность регулярной операции"
                values: ["Каждый день", "Каждую неделю", "Каждый месяц", "Каждый год"]
        GridLayout:
            cols: 2
            MDLabel:
                text: "Настройка уведомления"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            Spinner:
                id: reg_op_notification
                text: "Выберите периодичность уведомлений"
                values: ["За месяц", "За неделю", "За день", "В тот же день", "Через день"]
        GridLayout:
            cols: 2
            Button:
                text: "Удалить операцию"
                on_release:
                    root.remove_reg_op()
            Button:
                text: "Сохранить изменения"
                on_release:
                    root.update_reg_op(reg_op_name.text, reg_op_type.text, reg_op_sum.text, reg_op_period.text, reg_op_notification.text)
        Button:
            text: "Вернуться"
            on_release:
                app.root.current="main"
                root.manager.transition.direction = "down"


<AddRegularOperationScreen>:
    name: "add_reg_op"
    GridLayout:
        cols: 1
        MDLabel:
            text: "Добавление регулярной операции"
            halign: 'center'
            pos_hint: {'center_y':0.9}
            font_style: 'H4'        
        GridLayout:
            cols: 2
            MDLabel:
                text: "Введите название"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: reg_op_name
        GridLayout:
            cols: 2
            MDLabel:
                text: "Выбор типа регулярной операции"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            Spinner:
                id: reg_op_type
                text: "Выберите тип регулярной операции"
                values: root.reg_op_types
        GridLayout:
            cols: 2
            MDLabel:
                text: "Сумма регулярной операции"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: reg_op_sum
        GridLayout:
            cols: 2
            MDLabel:
                text: "Выбор периодичности"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            Spinner:
                id: reg_op_period
                text: "Выберите периодичность регулярной операции"
                values: ["Каждый день", "Каждую неделю", "Каждый месяц", "Каждый год"]
        GridLayout:
            cols: 2
            MDLabel:
                text: "Настройка уведомления"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            Spinner:
                id: reg_op_notification
                text: "Выберите периодичность уведомлений"
                values: ["За месяц", "За неделю", "За день", "В тот же день", "Через день"]
        GridLayout:
            cols: 2
            Button:
                text: "Вернуться"
                on_release:
                    app.root.current="main"
                    root.manager.transition.direction = "down"
            Button:
                text: "Добавить"
                on_release:
                    root.add_reg_op(reg_op_name.text, reg_op_type.text, reg_op_sum.text, reg_op_period.text, reg_op_notification.text)


<RegularOperationTypesScreen>:
    name: "reg_op_types"

<StatisticsScreen>:
    name: "stats"
    GridLayout:
        cols: 1
        MDLabel:
            text: "Статистика"
            halign: 'center'
            pos_hint: {'center_y':0.9}
            font_style: 'H4'
        GridLayout:
            cols: 2
            MDLabel:
                text: "Введите дату начала периода аналитики"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: start_date
        GridLayout:
            cols: 2
            MDLabel:
                text: "Введите дату окончания периода аналитики"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: end_date
        GridLayout:
            cols: 2
            MDLabel:
                text: "Выбор типа регулярной операции"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            Spinner:
                id: reg_op_type_stat
                text: "Выберите тип регулярной операции"
                values: root.reg_op_types_statistics   
        GridLayout:
            cols: 2
            MDLabel:
                text: "Сумма прихода за период:"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: total_income
        GridLayout:
            cols: 2
            MDLabel:
                text: "Сумма платежей за период:"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: total_spend
        GridLayout:
            cols: 2
            MDLabel:
                text: "Итог:"
                halign: 'center'
                pos_hint: {'center_y':0.7}
                text_color: (0.101, 0.505, 0.576, 0.824)
                font_style: 'H6'
                theme_text_color: 'Custom'
            TextInput:
                id: total
        GridLayout:
            cols: 2
            Button:
                text: "Посчитать"
                on_release:
                    root.get_statistics(reg_op_type_stat.text, start_date.text, end_date.text)

            Button:
                text: "Вернуться"
                on_release:
                    app.root.current="main"
                    root.manager.transition.direction = "left"
                

<SecretMenuScreen>:
    name: "secret"
    Button:
        text: "Вернуться"
        on_release:
            app.root.current="main"
            root.manager.transition.direction = "left"